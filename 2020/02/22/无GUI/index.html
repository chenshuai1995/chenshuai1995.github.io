<!DOCTYPE HTML>
<html lang="zh-Hans">

<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Hexo">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->

<meta name="keywords" content="科学上网">


<meta name="description" content="




使用 shadowsocks无GUI客户端 的各种常见的代理
让shadowsocks跑起来
安装
配置
启动
开机自启


浏览器代理
安装 SwitchyOmega 插件
配置 P...">


<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->

<title>
    
    使用 shadowsocks无GUI客户端 的各种常见的代理 |
    
    Hexo
</title>

<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    

<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.7.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">
    
<div class="hide">
    <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</div>




    

</head></html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
    <header class="main-header"  style="background-image:url(
    http://snippet.shenliyang.com/img/banner.jpg)"
     >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='John Doe'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
            <!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
            <h2>
                天降大任，舍我其谁！
            </h2>
            
        </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                        <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://yoursite.com">
                        Hexo</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                        <li role="presentation" class="text-center">
                            <a href="/"><i class="fa "></i>
                                首页</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/大数据/"><i class="fa "></i>
                                大数据</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/后端/"><i class="fa "></i>
                                后端</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/Linux/"><i class="fa "></i>
                                Linux</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/categories/工具/"><i class="fa "></i>
                                工具</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/archives/"><i class="fa "></i>
                                时间轴</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="使用 shadowsocks无GUI客户端 的各种常见的代理">
            
            使用 shadowsocks无GUI客户端 的各种常见的代理
            
        </h1>
        <div class="post-meta">
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            <a class="tag-link" href="/tags/科学上网/">科学上网</a>
            
        </span>
    </span>
    
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">
            2020/02/22</span>
    </span>
    
    <span class="fa-wrap">
        <i class="fa fa-eye"></i>
        <span id="busuanzi_value_page_pv"></span>
    </span>
    
    
</div>
        
        
    </div>
    
    <div class="post-body post-content">
        <div class="toc">

<!-- toc -->

<ul>
<li><a href="#shi-yong-shadowsocks-wu-gui-ke-hu-duan-de-ge-chong-chang-jian-de-dai-li">使用 shadowsocks无GUI客户端 的各种常见的代理</a><ul>
<li><a href="#rang-shadowsocks-pao-qi-lai">让shadowsocks跑起来</a><ul>
<li><a href="#an-zhuang">安装</a></li>
<li><a href="#pei-zhi">配置</a></li>
<li><a href="#qi-dong">启动</a></li>
<li><a href="#kai-ji-zi-qi">开机自启</a></li>
</ul>
</li>
<li><a href="#liu-lan-qi-dai-li">浏览器代理</a><ul>
<li><a href="#an-zhuang-switchyomega-cha-jian">安装 SwitchyOmega 插件</a></li>
<li><a href="#pei-zhi-proxy-profile">配置 Proxy Profile</a></li>
<li><a href="#pei-zhi-switch-profile">配置 Switch Profile</a></li>
<li><a href="#qi-yong-switchyomega">启用 SwitchyOmega</a></li>
</ul>
</li>
<li><a href="#xi-tong-dai-li">系统代理</a></li>
<li><a href="#zhong-duan-dai-li">终端代理</a><ul>
<li><a href="#fang-fa-yi-proxychains-tui-jian">方法一：proxychains（推荐）</a></li>
<li><a href="#fang-fa-er-polipo">方法二：polipo</a></li>
</ul>
</li>
<li><a href="#qi-ta-dai-li-pip-git">其他代理(pip|git)</a><ul>
<li><a href="#git-shi-yong-dai-li">git 使用代理</a></li>
<li><a href="#pip-shi-yong-dai-li">pip 使用代理</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div>


<h1><span id="shi-yong-shadowsocks-wu-gui-ke-hu-duan-de-ge-chong-chang-jian-de-dai-li">使用 shadowsocks无GUI客户端 的各种常见的代理</span><a href="#shi-yong-shadowsocks-wu-gui-ke-hu-duan-de-ge-chong-chang-jian-de-dai-li" class="header-anchor"></a></h1><h2><span id="rang-shadowsocks-pao-qi-lai">让shadowsocks跑起来</span><a href="#rang-shadowsocks-pao-qi-lai" class="header-anchor"></a></h2><h3><span id="an-zhuang">安装</span><a href="#an-zhuang" class="header-anchor"></a></h3><p><strong>Debian/Ubuntu:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install python-pip  # 已经安装了pip的话跳过</span><br><span class="line">pip install shadowsocks</span><br></pre></td></tr></table></figure>

<p><strong>CentOS:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install python-setuptools &amp;&amp; easy_install pip</span><br><span class="line">sudo pip install shadowsocks</span><br></pre></td></tr></table></figure>

<h3><span id="pei-zhi">配置</span><a href="#pei-zhi" class="header-anchor"></a></h3><p>找个地方放shadowsocks的配置文件，一般放到 <code>/etc</code>下面：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/shadowsocks.json</span><br></pre></td></tr></table></figure>

<p>比如我放在用户目录下，因为有时需要修改，放在这里方便些：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /home/your-username/shadowsocks.json</span><br></pre></td></tr></table></figure>

<p>你可以根据自身情况考虑，文件名和路径都可以随意设置，只要自己能记住就行。</p>
<p>然后在<code>shadowsocks.json</code>里面添加配置信息，如：（注意双引号）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;server&quot;:&quot;your_server_ip&quot;,</span><br><span class="line">  &quot;local_address&quot;: &quot;127.0.0.2&quot;,</span><br><span class="line">  &quot;local_port&quot;:1080,</span><br><span class="line">  &quot;server_port&quot;:your_server_port,</span><br><span class="line">  &quot;password&quot;:&quot;your_server_password&quot;,</span><br><span class="line">  &quot;timeout&quot;:600,</span><br><span class="line">  &quot;method&quot;:&quot;aes-128-ctr&quot;,</span><br><span class="line">  &quot;fast_open&quot;:false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>把</p>
<ul>
<li><code>your_server_ip</code>改为自己的服务器IP</li>
<li><code>your_server_port</code>改为自己的服务器端口</li>
<li><code>your_server_password</code>改为自己的密码</li>
<li><code>method</code>的值改为自己的加密方式，一般是<code>aes-256-cfb</code>或者<code>rc4-md5</code></li>
</ul>
<p>详细配置说明：</p>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">server</td>
<td align="left">服务器地址，填ip或域名</td>
</tr>
<tr>
<td align="left">local_address</td>
<td align="left">本地地址</td>
</tr>
<tr>
<td align="left">local_port</td>
<td align="left">本地端口，一般1080，可任意</td>
</tr>
<tr>
<td align="left">server_port</td>
<td align="left">服务器对外开的端口</td>
</tr>
<tr>
<td align="left">password</td>
<td align="left">密码，可以每个服务器端口设置不同密码</td>
</tr>
<tr>
<td align="left">port_password</td>
<td align="left">server_port + password ，服务器端口加密码的组合</td>
</tr>
<tr>
<td align="left">timeout</td>
<td align="left">超时重连</td>
</tr>
<tr>
<td align="left">method</td>
<td align="left">默认: “aes-256-cfb”，见 <a href="https://github.com/shadowsocks/shadowsocks/wiki/Encryption" target="_blank" rel="noopener">Encryption</a></td>
</tr>
<tr>
<td align="left">fast_open</td>
<td align="left">开启或关闭 <a href="https://github.com/shadowsocks/shadowsocks/wiki/TCP-Fast-Open" target="_blank" rel="noopener">TCP_FASTOPEN</a>, 填true / false，需要服务端支持</td>
</tr>
</tbody></table>
<p>保存退出就配置好啦！</p>
<h3><span id="qi-dong">启动</span><a href="#qi-dong" class="header-anchor"></a></h3><p>配置文件的路径改成自己的，如：<code>/etc/shadowsocks.json</code></p>
<ul>
<li>前端启动：<code>sslocal -c /home/your-username/shadowsocks.json</code>；</li>
<li>后端启动：<code>sslocal -c /home/your-username/shadowsocks.json -d start</code>；</li>
<li>后端停止：<code>sslocal -c /home/your-username/shadowsocks.json -d stop</code>；</li>
<li>重启(修改配置要重启才生效)：<code>sslocal -c /home/your-username/shadowsocks.json -d restart</code></li>
</ul>
<h3><span id="kai-ji-zi-qi">开机自启</span><a href="#kai-ji-zi-qi" class="header-anchor"></a></h3><p>以下使用Systemd来实现shadowsocks开机自启。</p>
<p>先检查一下<code>sslocal</code> 的具体目录，然后配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ where sslocal</span><br><span class="line">/usr/local/bin/sslocal</span><br><span class="line">$ sudo vim /etc/systemd/system/shadowsocks.service</span><br></pre></td></tr></table></figure>

<p>在里面填写如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Shadowsocks Client Service</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">User=root</span><br><span class="line">ExecStart=/usr/local/bin/sslocal -c /home/your-username/shadowsocks.json</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>把 <code>/usr/bin/local/sslocal</code> 修改为你的 <code>sslocal</code> 所在路径，如 <code>/usr/bin/sslocal</code></p>
<p>把<code>/home/your-username/shadowsocks.json</code>修改为你的<code>shadowsocks.json</code>所在路径，如：<code>/etc/shadowsocks.json</code></p>
<blockquote>
<p>小提示：复制上面的内容后，在 vim 中标准(Normal)模式下，输入 <code>&quot;+p</code> (输入英文引号、加号、p)可以实现粘贴。</p>
<p>小知识：如果发现粘贴不了，那是因为只有vim.gtk或vim.gnome才能使用系统全局粘贴板，默认的vim.basic看不到<code>+</code>号寄存器。安装vim.gnome使用<code>apt-get install vim-gnome</code>，然后vim自动会链接到vim.gnome。</p>
</blockquote>
<p>配置生效：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable /etc/systemd/system/shadowsocks.service</span><br></pre></td></tr></table></figure>

<p>输入管理员密码就可以了。</p>
<p>现在你可以马上重启试试，或先在后台启动，等下次重启再看看！</p>
<hr>
<p>正常来说，我们主要是通过浏览器去访问一些被墙的网站，而且大多数人也仅仅只用浏览器科学上网，所以浏览器的代理就成为重中之重。下面具体阐述如何实现浏览器代理。</p>
<h2><span id="liu-lan-qi-dai-li">浏览器代理</span><a href="#liu-lan-qi-dai-li" class="header-anchor"></a></h2><h3><span id="an-zhuang-switchyomega-cha-jian">安装 SwitchyOmega 插件</span><a href="#an-zhuang-switchyomega-cha-jian" class="header-anchor"></a></h3><p>以 Chrome 为例，安装 SwitchyOmega 插件代理。</p>
<p>Github 下载 SwitchyOmega：<a href="https://github.com/FelisCatus/SwitchyOmega/releases/" target="_blank" rel="noopener">https://github.com/FelisCatus/SwitchyOmega/releases/</a></p>
<p>Chrome 打开<a href="chrome://extensions/" target="_blank" rel="noopener">chrome://extensions/</a>，把插件托进去安装。</p>
<h3><span id="pei-zhi-proxy-profile">配置 Proxy Profile</span><a href="#pei-zhi-proxy-profile" class="header-anchor"></a></h3><p>打开插件配置页面，点击左下角的 “+New profile…” ，在弹出的窗口中选择“Proxy Profile”，名字随便起(比如ss)，创建完成后配置一下：</p>
<ul>
<li><code>Server</code>填写<code>shadowsocks.json</code>配置中的<code>local_address</code></li>
<li><code>Port</code>填写<code>shadowsocks.json</code>配置中的<code>local_port</code></li>
<li>下面的 Bypass List 填上不需要走代理的地址，比如：<code>shadowsocks.json</code>配置中的<code>local_address</code>应该填进去。</li>
<li>好了，点击左边绿色的<code>Apply changes</code>保存。</li>
</ul>
<p><a href="http://p1nwamyah.bkt.clouddn.com/18-4-13/63345407.jpg" target="_blank" rel="noopener"><img src="http://p1nwamyah.bkt.clouddn.com/18-4-13/63345407.jpg" alt="img"></a></p>
<h3><span id="pei-zhi-switch-profile">配置 Switch Profile</span><a href="#pei-zhi-switch-profile" class="header-anchor"></a></h3><p>同样点击左下角的 “+New profile…” ，在弹出的窗口中选择“Switch Profile”，名字随便起，创建完成后如图：</p>
<p><a href="http://p1nwamyah.bkt.clouddn.com/18-4-13/18099298.jpg" target="_blank" rel="noopener"><img src="http://p1nwamyah.bkt.clouddn.com/18-4-13/18099298.jpg" alt="img"></a></p>
<p>先点击“+Add a rule list”，然后开始配置：</p>
<p><a href="http://p1nwamyah.bkt.clouddn.com/18-4-13/84531209.jpg" target="_blank" rel="noopener"><img src="http://p1nwamyah.bkt.clouddn.com/18-4-13/84531209.jpg" alt="img"></a></p>
<ul>
<li><p>勾上<code>Rule list rules</code>，右边的<code>Profile</code>列在下拉框中选择刚才创建的<code>ss</code></p>
</li>
<li><p><code>Default</code>的<code>Profile</code>列，选择直连模式<code>[Direct]</code></p>
</li>
<li><p><code>Rule List Format</code>选择<code>AutoProxy</code></p>
</li>
<li><p>下面的<code>Rule List URL</code>填写<code>gfwlist</code>地址:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载规则文件，点击<code>Download Profile Now</code></p>
</li>
<li><p>点击左边绿色的<code>Apply changes</code>保存</p>
</li>
</ul>
<h3><span id="qi-yong-switchyomega">启用 SwitchyOmega</span><a href="#qi-yong-switchyomega" class="header-anchor"></a></h3><p>启用 SwitchyOmega 插件，选择 Auto Switch 模式就可以了。</p>
<h2><span id="xi-tong-dai-li">系统代理</span><a href="#xi-tong-dai-li" class="header-anchor"></a></h2><p>如有你有系统全局代理的需要，那么就往下看，否则只需要参考上文的 <a href="http://godsing.top/2018/04/13/Linux下shadowsocks各种代理方式总结/#浏览器代理" target="_blank" rel="noopener">浏览器代理</a> 即可。</p>
<p>找到“网络”配置项：</p>
<p><a href="http://p1nwamyah.bkt.clouddn.com/18-4-13/53938885.jpg" target="_blank" rel="noopener"><img src="http://p1nwamyah.bkt.clouddn.com/18-4-13/53938885.jpg" alt="img"></a></p>
<p>设置成如下：</p>
<p><a href="http://p1nwamyah.bkt.clouddn.com/18-4-13/62362422.jpg" target="_blank" rel="noopener"><img src="http://p1nwamyah.bkt.clouddn.com/18-4-13/62362422.jpg" alt="img"></a></p>
<p>设置完成点击”Apply system wide”，需要输入验证权限，输入密码即可，这里开启的默认版本是socks5。</p>
<p>Tips: 如果要关闭系统代理，上图中的那个 Method 选择 “None”，然后同样点击”Apply system wide”即可。</p>
<p>系统代理是全局走代理的，访问国内网站就不太方便了，相当于绕了个弯，速度变慢，甚至是访问反而受限了，如无必要，还是推荐浏览器方式按规则选择性代理。</p>
<hr>
<p>这样设置后，浏览器一般可以正常科学上网了，因为浏览器基本上都能完美支持http代理和socks代理。然而终端里执行的程序基本上都不能友好的支持socks代理，在终端要使用socks代理，常见的有两种方法：使用 polipo 或 proxychains，以下分别介绍。</p>
<h2><span id="zhong-duan-dai-li">终端代理</span><a href="#zhong-duan-dai-li" class="header-anchor"></a></h2><h3><span id="fang-fa-yi-proxychains-tui-jian">方法一：proxychains（推荐）</span><a href="#fang-fa-yi-proxychains-tui-jian" class="header-anchor"></a></h3><p>Tips: 使用 proxychains 不需要开启系统代理，只要启动着 shadowsocks 就可以了。</p>
<h4><span id="an-zhuang">安装</span><a href="#an-zhuang" class="header-anchor"></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install proxychains   # 安装 proxychains</span><br></pre></td></tr></table></figure>

<h4><span id="pei-zhi">配置</span><a href="#pei-zhi" class="header-anchor"></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 777 /etc/proxychains.conf # 原始权限不足，需要修改权限</span><br><span class="line">vim /etc/proxychains.conf</span><br><span class="line">sudo chmod 644 /etc/proxychains.conf # 保存好配置后，权限修改回去</span><br></pre></td></tr></table></figure>

<p>编辑配置文件时，将最下面类似 <code>socks4 127.0.0.1 9050</code> 的一行注释掉，添加一行 <code>socks5 127.0.0.1 1080</code> 这里的IP地址和端口就是上面刚刚设置的系统代理的 <code>Socks Host</code> 和端口。</p>
<h4><span id="ce-shi">测试</span><a href="#ce-shi" class="header-anchor"></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains curl www.google.com</span><br></pre></td></tr></table></figure>

<h4><span id="shi-yong">使用</span><a href="#shi-yong" class="header-anchor"></a></h4><p>在正常使用的命令行前面，加上 <code>proxychains</code>（如上面测试的命令）， 该命令就会使用代理。</p>
<p>也可以通过输入<code>proxychains bash</code>建立一个新的bash，基于这个bash运行的所有命令都将使用代理。</p>
<h3><span id="fang-fa-er-polipo">方法二：polipo</span><a href="#fang-fa-er-polipo" class="header-anchor"></a></h3><p>Tips: 该部分以 http_proxy 为例，socks5 是否可行未知，可自行google。</p>
<h4><span id="an-zhuang-polipo">安装polipo</span><a href="#an-zhuang-polipo" class="header-anchor"></a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install polipo</span><br></pre></td></tr></table></figure>

<h4><span id="xiu-gai-pei-zhi-wen-jian">修改配置文件</span><a href="#xiu-gai-pei-zhi-wen-jian" class="header-anchor"></a></h4><p>config文件是只读的，要想修改里面的数据，需要获得最高权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cd /etc/polipo/</span><br><span class="line">$ sudo chmod 777 config # 为config文件申请最高权限</span><br><span class="line">$ vim /etc/polipo/config # 打开进行编辑</span><br></pre></td></tr></table></figure>

<p>原文件中已经有了两句话，那么需要新加入3句话：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">socksParentProxy = &quot;localhost:1080&quot;</span><br><span class="line">socksProxyType = socks5</span><br><span class="line">logLevel=4</span><br></pre></td></tr></table></figure>

<p>ps：这里建议修改文件后恢复其本来的权限，这算是个好习惯。</p>
<h4><span id="guan-bi-he-qi-dong-polipo">关闭和启动polipo</span><a href="#guan-bi-he-qi-dong-polipo" class="header-anchor"></a></h4><p>关闭软件，让配置生效，然后重启。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo service polipo stop</span><br><span class="line">$ sudo service polipo start</span><br></pre></td></tr></table></figure>

<h4><span id="yan-zheng-he-shi-yong">验证和使用</span><a href="#yan-zheng-he-shi-yong" class="header-anchor"></a></h4><p>安装完成后使用下面代码验证效果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl ip.gs #查询你的IP地址和地理信息</span><br><span class="line">$ http_proxy=http://localhost:8123 curl ip.gs</span><br></pre></td></tr></table></figure>

<p>第二条语句得到的ip地址已经不是中国的了：“当前 IP：103.204.172.117 来自：日本大阪府大阪 starrydns.com”，说明安装成功。</p>
<p>上面实验说明了想要为某个命令加上代理，就在前面使用：http_proxy=<a href="http://localhost:8123/" target="_blank" rel="noopener">http://localhost:8123</a></p>
<p>ps：8123是polipo的默认端口，如有需要，可以修改成其他有效端口。</p>
<h4><span id="she-zhi-bie-ming">设置别名</span><a href="#she-zhi-bie-ming" class="header-anchor"></a></h4><p>每一次都输入这么一串命令实在太不人性化，解决方法就是给这个命令一个缩写的别名，比如“hp”。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim .bashrc</span><br></pre></td></tr></table></figure>

<p>打开配置文件，在最后面加上一句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias hp=&quot;http_proxy=http://localhost:8123&quot;</span><br></pre></td></tr></table></figure>

<p>关闭文件，执行下面代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ source ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>这样，hp就可以代表之前很长的命令，试验一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hp curl ip.gs</span><br></pre></td></tr></table></figure>

<p>当前 IP：103.204.172.117 来自：日本大阪府大阪 starrydns.com ，bingo！</p>
<h4><span id="wei-dang-qian-hui-hua-she-zhi-quan-ju-dai-li">为当前会话设置全局代理</span><a href="#wei-dang-qian-hui-hua-she-zhi-quan-ju-dai-li" class="header-anchor"></a></h4><p>难道要在每条联网命令前面都加上“hp”？当然不会，以下操作可以让<strong>当前终端</strong>窗口的所有联网命令都经过代理，一条命令，接管所有：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ export http_proxy=http://localhost:8123 # 当前终端使用代理</span><br><span class="line">$ unset http_proxy # 当前终端取消代理</span><br></pre></td></tr></table></figure>

<h4><span id="geng-wei-chang-jiu-de-dai-li-she-zhi">更为长久的代理设置</span><a href="#geng-wei-chang-jiu-de-dai-li-she-zhi" class="header-anchor"></a></h4><p>如果我想Ubuntu终端一直处于代理状态，能不能做到呢？这也是可以的，以下设置可以让本机的终端一直拥有代理能力，设置好后就完全不用操心了，类似于写入环境变量的操作。</p>
<p>方法很简单，将以下语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=http://localhost:8123</span><br></pre></td></tr></table></figure>

<p>加入.bashrc文件末尾，再执行<code>source ~/.bashrc</code>即可；或者如果你使用了zsh，那么就是 ~/.zshrc。</p>
<p>现在有很多网站使用了更安全的https协议，因此，上一句若为<code>export https_proxy=http://localhost:8123</code> 则能对htttps协议起作用，但是这两句在bashrc中共存，貌似会出问题，这里博主使用别名“hps”来调用，确保不出错。那下文的例子就很好解释了。</p>
<p><strong>ps：实际使用中，某些命令貌似还是需要单独加hp，比如我用wget命令下载文件的时候，加上了别名hp ，下载速度才快得起来，例如：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 加上hp，才能达到1M/s以上的下载速度</span><br><span class="line">wget hp https://sourceforge.net/projects/opencvlibrary/files/opencv-unix/2.4.9/opencv-2.4.9.zip/download</span><br></pre></td></tr></table></figure>

<h2><span id="qi-ta-dai-li-pip-git">其他代理(pip|git)</span><a href="#qi-ta-dai-li-pip-git" class="header-anchor"></a></h2><h3><span id="git-shi-yong-dai-li">git 使用代理</span><a href="#git-shi-yong-dai-li" class="header-anchor"></a></h3><p>刚才的一大堆设置对git命令没有作用，为此我们要单独设置。</p>
<p>事实上在git命令最后加参数可以实现代理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--config http.proxy=localhost:8123</span><br></pre></td></tr></table></figure>

<p>但我们仍然觉得不方便，还是起个别名吧，比如就叫“gp”。</p>
<p>在.bashrc文件末尾加入这一句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gp=&quot; --config http.proxy=localhost:8123&quot;</span><br></pre></td></tr></table></figure>

<p>执行<code>source ~/.bashrc</code></p>
<p>以后，在git clone命令后面加入<code>$gp</code>就可以加快克隆速度，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/gmarik/Vundle.vim.git $gp</span><br></pre></td></tr></table></figure>

<h3><span id="pip-shi-yong-dai-li">pip 使用代理</span><a href="#pip-shi-yong-dai-li" class="header-anchor"></a></h3><p>在配置完系统代理后，不需要配置 polipo 或 proxychains (配了似乎也没用？参见“后话”)，直接使用以下方法就可以实现代理，举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip --proxy socks5://127.0.0.2:1080 install tensorflow</span><br></pre></td></tr></table></figure>

<p>pip 虽然能够管理包，却没有切换镜像源的功能，而我们下载的包，大多数都在国外大型的代码托管服务器上，这就导致了往往几M的包要下载一个小时。</p>
<p>如果你已经给电脑部署了 HTTPS 以及 HTTP 代理，甚至给终端也配置了代理，但 pip 不吃这一套，所以就需要单独给 pip 设置代理。</p>
<p>所幸，pip 有个选项，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--proxy &lt;proxy&gt;        Specify a proxy in the form [user:passwd@]proxy.server:port.</span><br></pre></td></tr></table></figure>

<p>我们直接用这个命令就好了，不过这个命令需要每次在你下载包时附加，比如这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 --proxy 127.0.0.1:6152 install snowlp</span><br></pre></td></tr></table></figure>

<p>这太麻烦了，编辑 ~/.bashrc 文件，或者如果你使用了zsh，那么就是 ~/.zshrc ,在文末添加 <code>alias pip3=&quot;pip3 --proxy 127.0.0.1:6152&quot;</code> (像我使用socks代理，则添加 <code>alias pip3=&quot;pip3 --proxy socks5://127.0.0.2:1080&quot;</code> )，下次打开终端后就不用每次都输入这么长的代理选项了。</p>
<p>后话：</p>
<p>如果使用 <code>sudo proxychains pip install 包名</code> 的方式实现 pip 代理，可能会<a href="https://stackoverflow.com/questions/38794015/pythons-requests-missing-dependencies-for-socks-support-when-using-socks5-fro" target="_blank" rel="noopener">报错</a>，这时候可以尝试先把系统代理关了(不关可能也行，只是速度慢)，然后 <code>sudo pip install pysocks</code> ，装完后再开启系统代理，再使用 <code>sudo proxychains pip install 包名</code> 的方式。很大可能仍然不行，比如我的会报错（无法识别socks版本）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ValueError: Unable to determine SOCKS version from socks://127.0.0.2:1080/</span><br></pre></td></tr></table></figure>

<p>可是我在 proxychains.conf 里都已经配置了 socks5 了，为什么识别不了呢？欢迎留言或发邮件讨论。</p>
<h2><span id="reference">Reference</span><a href="#reference" class="header-anchor"></a></h2><ol>
<li><a href="http://godsing.top/2018/04/13/Linux%E4%B8%8Bshadowsocks%E5%90%84%E7%A7%8D%E4%BB%A3%E7%90%86%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">Linux下shadowsocks各种代理方式总结</a></li>
<li><a href="https://blog.huihut.com/2017/08/25/LinuxInstallConfigShadowsocksClient/" target="_blank" rel="noopener">Linux安装配置Shadowsocks客户端及开机自动启动</a></li>
<li><a href="http://zheng-zy.github.io/posts/30918/" target="_blank" rel="noopener">ubuntu16.04LTS+shadowsocks+proxychains全局访问</a></li>
<li><a href="https://blog.csdn.net/Jesse_Mx/article/details/52863204" target="_blank" rel="noopener">Ubuntu系统下浏览器和终端的SS代理配置</a></li>
<li><a href="https://www.logcg.com/archives/1914.html" target="_blank" rel="noopener">让 pip 走代理</a></li>
<li><a href="http://govfate.iteye.com/blog/2069022" target="_blank" rel="noopener">ubuntu开启http和socks全局代理测试与检验</a></li>
</ol>

    </div>
    
    <div class="post-footer">
        <div>
            
            转载声明：
            商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">Jim Chen</a>
            
            
        </div>
        <div>
            
        </div>
    </div>
</article>
<div class="article-nav prev-next-wrap clearfix">
    
    
    <a href="/2019/10/13/Ubuntu18-04-使用Shadowsocks-科学上网/" class="next-post btn btn-default" title='Ubuntu18.04 使用Shadowsocks 科学上网'>
        <span class="hidden-lg">下一篇</span>
        <span class="hidden-xs">
            Ubuntu18.04 使用Shadowsocks 科学上网</span><i class="fa fa-angle-right fa-fw"></i>
    </a>
    
</div>

<div id="comments">
    
<div id="lv-container" data-id="city" data-uid="MTAyMC80NzAzOC8yMzUzOA==">
    <script type="text/javascript">
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
    </script>
</div>

</div>

                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">
            Table of Contents
        </h3>
        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-text">使用 shadowsocks无GUI客户端 的各种常见的代理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">让shadowsocks跑起来</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">开机自启</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">浏览器代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">安装 SwitchyOmega 插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">配置 Proxy Profile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">配置 Switch Profile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">启用 SwitchyOmega</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">系统代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">终端代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">方法一：proxychains（推荐）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">方法二：polipo</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">安装polipo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">修改配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">关闭和启动polipo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">验证和使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">设置别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">为当前会话设置全局代理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">更为长久的代理设置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">其他代理(pip|git)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">git 使用代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#null"><span class="toc-text">pip 使用代理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">Reference</span></a></li></ol></li></ol>
        
    </div>
</aside>
                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>
<a id="back-to-top" class="icon-btn hide">
    <i class="fa fa-chevron-up"></i>
</a>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
    Total:
    <strong id="busuanzi_value_site_pv">
        <i class="fa fa-spinner fa-spin"></i>
    </strong>
    &nbsp; | &nbsp;
    Visitors:
    <strong id="busuanzi_value_site_uv">
        <i class="fa fa-spinner fa-spin"></i>
    </strong>
    
</div>
            </div>
            <div class="col-sm-12">
                <span>Copyright &copy;
                    2019
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/js/app.js?rev=@@hash"></script>
</body>
</html>